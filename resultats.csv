import csv
import os

# Fichier o√π stocker les r√©sultats
FICHIER_RESULTATS = "resultats.csv"

# D√©finition du quiz avec les nouvelles questions
quiz = [
    {"question": "De quelle couleur sont les bananes m√ªres ?", "options": ["Rouge", "Bleu", "Jaune"], "answer": 3},
    {"question": "En quelle ann√©e Christophe Colomb a-t-il d√©couvert l'Am√©rique ?", "options": ["1492", "1500", "1600"], "answer": 1}
]

def jouer_quiz():
    """Fonction pour jouer au quiz et enregistrer le score dans un fichier CSV."""
    nom = input("Entrez votre nom : ")
    score = 0

    for i, q in enumerate(quiz, start=1):
        print(f"\nQuestion {i}: {q['question']}")
        for idx, option in enumerate(q["options"], start=1):
            print(f"{idx}) {option}")

        while True:
            try:
                answer = int(input("Votre r√©ponse (1/2/3) : "))
                if 1 <= answer <= 3:
                    break
                else:
                    print("Veuillez entrer un nombre entre 1 et 3.")
            except ValueError:
                print("Veuillez entrer un nombre valide.")

        if answer == q["answer"]:
            print("‚úÖ Bonne r√©ponse !")
            score += 1
        else:
            print("‚ùå Mauvaise r√©ponse.")

    print(f"\n{nom}, votre score final : {score}/{len(quiz)}")
    
    # Enregistrer le score dans le fichier CSV
    date = "2024-04-15"  # Date statique, mais tu peux la changer dynamiquement si n√©cessaire
    with open(FICHIER_RESULTATS, mode="a", newline="") as file:
        writer = csv.writer(file)
        writer.writerow([nom, "G√©n√©ral", score, date])  # Th√®me g√©n√©ral pour ces questions

    print("‚úÖ R√©sultat enregistr√© dans le fichier CSV !")

def voir_resultats():
    """Fonction pour afficher les r√©sultats enregistr√©s depuis le fichier CSV."""
    if not os.path.exists(FICHIER_RESULTATS):
        print("Aucun r√©sultat trouv√©.")
        return

    with open(FICHIER_RESULTATS, mode="r") as file:
        reader = csv.reader(file)
        next(reader)  # Saute l'en-t√™te
        print("\nüìä R√©sultats des joueurs :")
        for row in reader:
            utilisateur, theme, score, date = row
            print(f"Utilisateur: {utilisateur} | Th√®me: {theme} | Score: {score} | Date: {date}")

# Menu principal
while True:
    print("\n1) Jouer au quiz")
    print("2) Voir les r√©sultats")
    print("3) Quitter")
    
    choix = input("Choisissez une option : ")
    
    if choix == "1":
        jouer_quiz()
    elif choix == "2":
        voir_resultats()
    elif choix == "3":
        print("√Ä bient√¥t ! üëã")
        break
    else:
        print("‚ùå Option invalide, essayez encore.")
